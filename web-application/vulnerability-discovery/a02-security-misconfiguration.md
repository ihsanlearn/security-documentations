# A02: Security Misconfiguration

**Security Misconfiguration** terjadi ketika sebuah sistem tidak diatur (dikonfigurasi) dengan standar keamanan yang ketat.

Ini bukan kesalahan pada _logika kode_ (seperti IDOR), melainkan kesalahan pada pengaturan (setup) server, _database_, _cloud_, atau _framework_ aplikasi itu sendiri.

***

### Security Headers

Security headers adalah instruksi yang server kirimkan ke browser pengguna untuk memberitahu browser tersebut bagaimana cara berperilaku aman.

#### Content-Security-Policy (CSP)

CSP adalah whitelist yang ketat untuk memberitahu browser tepatnya darimana saja ia boleh memuat sumber daya. Ini adalah pertahanan terbaik melawan XSS. Jika attacker berhasil `<script src="http://evil.com/malicious.js">`, _browser_ akan memblokirnya karena `evil.com` tidak ada di _whitelist_ CSP Anda.

Best Practice: `Content-Security-Policy: default-src 'self'; script-src 'self'; object-src 'none'; frame-ancestors 'none';`

#### Strict-Transport-Security (HSTS)

Fungsinya untuk memaksa browser untuk **selalu** menggunakan koneksi HTTPS setelah kunjungan pertama. Ini juga melindungi dari serangan downgrade (seperti SSL-stripping). Jika seorang attacker di WiFi publik mencoba downgrade koneksi dari HTTPS ke HTTP, maka browser akan menolaknya.

Best Practice: `Strict-Transport-Security: max-age=31536000; includeSubDomains; preload`&#x20;

#### X-Content-Type-Options

Fungsinya untuk memaksa browser **tidak menebak-nebak** tipe konten (MIME type). Ini mencegah serangan MIME-sniffing.

Best Practice: `X-Content-Type-Options: nosniff`

#### Referer-Policy

Fungsinya untuk mengontrol seberapa banyak informasi (URL) yang dikirim dalam header `Referer` dan mencegah kebocoran data sensitif di URL.

Best Practice: `Referrer-Policy: strict-origin-when-cross-origin`

***

### Vulnerabilities

1. Pengaturan default yang tidak aman
2. Pesan error yang terlalu jujur (Verbose Error Message)
3. Cloud Misconfiguration
4. Fitur halaman yang tidak perlu
5. Missing Security Headers
   1. Tidak ada `X-Content-Type-Option: nosniff`
   2. Tidak ada `Strict-Transport-Security (HSTS)`
   3. Tidak ada `Content-Security-Policy (CSP)`

***

### Tips

1. Gunakan Scanner Otomatis:
   1. Nmap: Pindai port yang terbuka di server.
   2. Nuclei: Gunakan template misconfiguration untuk mencari file log terksepos, panel admin, atau halaman debug yang lupa dihapus
2. Picu Error
   1. Coba hancurkan aplikasi di setiap input
   2. LIhat respons server, apakah dapat stack trace atau hanya error sopan seperti "Terjadi Kesalahan"
3. Periksa Headers
   1. Apakah ada security header yang hilang
