# Other Authentication Mechanism

***

#### Keeping Users Logged In

Pada kasus ini, terdapat beberapa kerentanan yang mungkin terjadi pada saat menggunakan mekanisme mempertahankan pengguna untuk tetap loggin untuk beberapa saat atau bahkan sampai user itu log out. Salah satunya adalah cookie yang lemah, hal ini dapat terjadi apabila cookie ini dapat dengan mudah diidentifikasi pembuatan cookie itu, misalnya hanya dengan menggunakan md5 hash atau base64 encode. Attacker mampu menganalisis lalu mencoba menerapkannya pada target.

***

### Password Reset Broken Logic

Ini adalah kesalahan fatal apabila terdapat kesalahan logika pada fungsi ini, as simple as terdapat parameter token yang dikirimkan pada link tautan reset password tapi token itu tidak divalidasi melainkan hanya username yang divalidasi, jadi attacker hanya perlu mengubah username yang mau diganti passwordnya.

#### Password Reset Poisoning

Password reset poisoning adalah sebuah teknik dimana penyerang memanipulasi sebuah website yang rentan untuk membuat reset link yang mengarah ke domain dibawah kontrol penyerang. Dengan cara ini penyerang dapat mencuri token rahasia yang dibutuhkan untuk mengatur ulang password pengguna, yang akhirnya sangat berbahaya untuk akun tersebut.

How to construct a password reset poisoning attack? Jika URL yang dikirimkan untuk reset password ini secara dinamis dibentuk berdasarkan input yang terkontrol seperti Host Header, ini dapat memungkinkan poisoning sebagai berikut:

1. Attacker mendapatkan email, usernam korban atau hal lain yang dibutuhkan untuk reset password. Ketika submit form, intercept HTTP Request untuk memodifikasi Host Header (atau hal lain yang dapat menjadi celah pengiriman URL seperti X-Forwarded-Host) yang mengarah ke domain attacker.
2. Korban menerima link password reset email dan bagian krusialnya adalah terdapat valid password reset token yang terhubung dengan akun korban. Tetapi nama domain pada URL mengarah pada domain attacker, seperti:\
   `https://attacker.com/reset-password?token=djoa2u2320934j23inwefwe`
3. Jika korban klik link ini (atau trigger dengan cara lain seperti antivirus scanner) password reset token akan terkirim langsung ke server penyerang
4. Kini penyerang dapat mengunjungi URL asli pada website rentan dan menggunakan token valid korban ke parameter yang sesuai. Pada titik ini penyerang dapat mengubah sandi akun korban dan menjadikan akun itu miliknya.
