# OAuth

***

### OAuth Grant Type

OAuth grant type ini mekanisme atau alur yang dipilih oleh sebuah aplikasi untuk mendapatkan izin (access token) dari layanan pihak ketiga (e.g. Google, Facebook, Github etc.)

***

### OAuth Scope

OAuth scope ini menentukan izin akses apa saja yang diberikan pengguna untuk aplikasi. Sebagai contoh ini ketika melakukan permintaan ke daftar kontak pengguna yang mungkin akan berbeda beda pada setiap layanan OAuth yang digunakan:

```javascript
scope=contacts
scope=contacts.read
scope=contact-list-r
scope=https://oauth-authorization-server.com/auth/scopes/user/contacts.readonly
```

#### Apa yang perlu dipertanyakan?

**Scope Expansion**

Kadang developer meminta scope yang terlalu luas misalkan `scope=files.full_access` padahal aplikasi cuma butuh baca nama file saja. Ini akan menjadi bahaya ketika aplikasi ini terkena hack.

**Scope Injection/OAuth Scope Validation Bypass**

Sebagai contoh, ada sebuah aplikasi yang meminta `read_profile`. Lalu attacker mencoba intercept request dan mengganti dengan menambah `full_access_token`. OAuth service ternyata mengizinkan itu dan menampilkan di layar persetujuan user. User klik OK lalu BOOM. Sekarang aplikasi punya akses penuh ke akun user tanpa validasi. Tanpa validasi ini artinya adalah awalnya backend meminta izin read profile, lalu backend menerima response yang tidak hanya read profile. Ini menjadi sebuah bug ketika backend tidak memvalidasi apa yang ia dapatkan.

#### Over Privileged Token Acceptance

Resource server tidak peduli pada token dengan scope apapun melainkan hanya menganggap selama token itu valid maka akses diberikan. Contohnya adalah token yang sebelumnya diminta akses read bisa digunakan untuk update atau delete resource.

#### OAuth Parameter Pollution

```javascript
scope=read_profile&scope=admin // Duplicate parameter
scope=read_profile%20admin     // Separator Manipulation (can be test with comma, semicolon or other)
scope[]=read&scope[]=write     // Array Injection
```

Server kemungkinan bisa salah parsing scope tanpa menggabungkan whitelist sekaligus bypass security filters

####
