# Typosquatting & Dependency Confusion

Kedua serangan ini punya tujuan yang sama: Menipu _developer_ atau _build system_ agar mengunduh dan menjalankan paket berbahaya yang menyamar sebagai paket yang sah.

***

## **Typosquatting (Penipuan "Salah Ketik")**

Ini adalah serangan yang menargetkan kesalahan manusia (human error).

* Konsep: Penyerang mempublikasikan paket berbahaya ke repositori publik (seperti npm, PyPI, RubyGems) dengan nama yang mirip sekali dengan paket populer, hanya salah ketik sedikit.
* Analogi: Anda ingin mengunjungi `google.com` tapi salah ketik `gogle.com`.
* Contoh Serangan:
  * Paket populer di Python adalah `requests`.
  * Penyerang membuat dan mengunggah paket _malware_ dengan nama `requesst` (salah satu 's').
  * Seorang _developer_ yang sedang terburu-buru salah mengetik: `pip install requesst`
  * GAME OVER. Saat instalasi, paket berbahaya itu langsung berjalan (misal: lewat file `setup.py`) dan bisa mencuri _API key_, _environment variables_, atau _SSH keys_ dari mesin _developer_.

### **Dependency Confusion (Kebingungan Dependensi)**

Ini jauh lebih canggih dan menargetkan kelemahan pada sistem _build_ otomatis (CI/CD). Ini adalah serangan "tingkat industri".

* Konsep: Banyak perusahaan menggunakan _campuran_ antara paket _publik_ (dari npm, PyPI) dan paket _internal/private_ (yang mereka buat sendiri dan simpan di _repository_ pribadi).
* Masalahnya: Nama paket _internal_ ini seringkali bisa ditebak atau bocor ke publik (misal: di dalam file `package.json` yang tidak sengaja ter-ekspos di JavaScript sisi klien).

Alur Serangan (Step-by-Step):

1. Recon (Pengintaian): Bug hunter (penyerang) memindai _source code_ JavaScript dari aplikasi web target. Mereka menemukan file `package.json` yang bocor dan melihat daftar dependensi. Mereka menemukan nama paket _internal_ yang tidak ada di npm publik, misalnya: `acme-internal-logger`.
2. Publish (Menerbitkan): Si _hunter_ membuat paket berbahaya (misal: yang mengirimkan `os.hostname()` dan `process.env` ke server mereka) dan menerbitkannya ke npm publik dengan nama yang _sama persis_: `acme-internal-logger`.
3. The Trick (Jebakan): Si _hunter_ mengeset versi paket palsu mereka ke versi yang sangat tinggi, misalnya `99.9.9`.
4. Execute (Eksekusi):
   * Di dalam perusahaan, seorang _developer_ atau _build server_ (CI/CD pipeline) menjalankan perintah `npm install`.
   * _Installer_ (npm) akan bingung. Ia melihat `acme-internal-logger` di dua tempat:
     * Di _repository private_ (versi 1.0.2)
     * Di _repository public_ (versi 99.9.9)
   * Karena versi publik terlihat lebih baru (99.9.9 > 1.0.2), _installer_ akan memilih dan mengunduh paket berbahaya dari npm publik.
5. GAME OVER. _Build server_ perusahaan baru saja terinfeksi, membocorkan rahasia internal ke penyerang.

***

**Perbedaan Utama:**

* Typosquatting: Menargetkan _developer_ yang salah ketik.
* Dependency Confusion: Menargetkan _build system_ yang bingung antara paket privat dan publik.
